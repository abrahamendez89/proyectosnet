SELECT N.CCVE_EMPL, 
 CASE WHEN MAX(N.NIMP_DIA1+N.NANT_DIA1+NSEP_DIA1+NPROD_DIA1)>=(SELECT TOP 1 T.NSUELDODIARIO+T.NSEPTIMO FROM nom_tabla_sueldos T WHERE T.ccve_nomina =N.CCVE_NOMINA AND T.ccve_temporada <= N.CCVE_TEMPORADA ORDER BY T.ccve_temporada DESC) THEN MAX(N.NIMP_DIA1+N.NANT_DIA1+NSEP_DIA1+NPROD_DIA1)-SUM(CASE WHEN CDIA=1 THEN S.NIMPORTE ELSE 0 END) ELSE MAX(N.NIMP_DIA1+N.NANT_DIA1+NSEP_DIA1+NPROD_DIA1) END AS DIA1,
 
 CASE WHEN MAX(N.NIMP_DIA2+N.NANT_DIA2+NSEP_DIA2+NPROD_DIA2)>=(SELECT TOP 1 T.NSUELDODIARIO+T.NSEPTIMO FROM nom_tabla_sueldos T WHERE T.ccve_nomina =N.CCVE_NOMINA AND T.ccve_temporada <= N.CCVE_TEMPORADA ORDER BY T.ccve_temporada DESC) THEN MAX(N.NIMP_DIA2+N.NANT_DIA2+NSEP_DIA2+NPROD_DIA2)-SUM(CASE WHEN CDIA=2 THEN S.NIMPORTE ELSE 0 END) ELSE MAX(N.NIMP_DIA2+N.NANT_DIA2+NSEP_DIA2+NPROD_DIA2) END AS DIA2,
 
 CASE WHEN MAX(N.NIMP_DIA3+N.NANT_DIA3+NSEP_DIA3+NPROD_DIA3)>=(SELECT TOP 1 T.NSUELDODIARIO+T.NSEPTIMO FROM nom_tabla_sueldos T WHERE T.ccve_nomina =N.CCVE_NOMINA AND T.ccve_temporada <= N.CCVE_TEMPORADA ORDER BY T.ccve_temporada DESC) THEN MAX(N.NIMP_DIA3+N.NANT_DIA3+NSEP_DIA3+NPROD_DIA3)-SUM(CASE WHEN CDIA=3 THEN S.NIMPORTE ELSE 0 END) ELSE MAX(N.NIMP_DIA3+N.NANT_DIA3+NSEP_DIA3+NPROD_DIA3) END AS DIA3,
 
 CASE WHEN MAX(N.NIMP_DIA4+N.NANT_DIA4+NSEP_DIA4+NPROD_DIA4)>=(SELECT TOP 1 T.NSUELDODIARIO+T.NSEPTIMO FROM nom_tabla_sueldos T WHERE T.ccve_nomina =N.CCVE_NOMINA AND T.ccve_temporada <= N.CCVE_TEMPORADA ORDER BY T.ccve_temporada DESC) THEN MAX(N.NIMP_DIA4+N.NANT_DIA4+NSEP_DIA4+NPROD_DIA4)-SUM(CASE WHEN CDIA=4 THEN S.NIMPORTE ELSE 0 END) ELSE MAX(N.NIMP_DIA4+N.NANT_DIA4+NSEP_DIA4+NPROD_DIA4) END AS DIA4,  

 CASE WHEN MAX(N.NIMP_DIA5+N.NANT_DIA5+NSEP_DIA5+NPROD_DIA5)>=(SELECT TOP 1 T.NSUELDODIARIO+T.NSEPTIMO FROM nom_tabla_sueldos T WHERE T.ccve_nomina =N.CCVE_NOMINA AND T.ccve_temporada <= N.CCVE_TEMPORADA ORDER BY T.ccve_temporada DESC) THEN MAX(N.NIMP_DIA5+N.NANT_DIA5+NSEP_DIA5+NPROD_DIA5)-SUM(CASE WHEN CDIA=5 THEN S.NIMPORTE ELSE 0 END) ELSE MAX(N.NIMP_DIA5+N.NANT_DIA5+NSEP_DIA5+NPROD_DIA5) END AS DIA5,
 
 CASE WHEN MAX(N.NIMP_DIA6+N.NANT_DIA6+NSEP_DIA6+NPROD_DIA6)>=(SELECT TOP 1 T.NSUELDODIARIO+T.NSEPTIMO FROM nom_tabla_sueldos T WHERE T.ccve_nomina =N.CCVE_NOMINA AND T.ccve_temporada <= N.CCVE_TEMPORADA ORDER BY T.ccve_temporada DESC) THEN MAX(N.NIMP_DIA6+N.NANT_DIA6+NSEP_DIA6+NPROD_DIA6)-SUM(CASE WHEN CDIA=6 THEN S.NIMPORTE ELSE 0 END) ELSE MAX(N.NIMP_DIA6+N.NANT_DIA6+NSEP_DIA6+NPROD_DIA6) END AS DIA6,
 
 CASE WHEN MAX(N.NIMP_DIA7+N.NANT_DIA7+NSEP_DIA7+NPROD_DIA7)>=(SELECT TOP 1 T.NSUELDODIARIO+T.NSEPTIMO FROM nom_tabla_sueldos T WHERE T.ccve_nomina =N.CCVE_NOMINA AND T.ccve_temporada <= N.CCVE_TEMPORADA ORDER BY T.ccve_temporada DESC) THEN MAX(N.NIMP_DIA7+N.NANT_DIA7+NSEP_DIA7+NPROD_DIA7)-SUM(CASE WHEN CDIA=7 THEN S.NIMPORTE ELSE 0 END) ELSE MAX(N.NIMP_DIA7+N.NANT_DIA7+NSEP_DIA7+NPROD_DIA7) END AS DIA7

INTO #RESULTADO
FROM NOM_REAL N
JOIN NOM_SUELDOS S ON N.CCVE_TEMPORADA=S.CCVE_TEMPORADA AND N.CCVE_NOMINA=S.CCVE_NOMINA AND N.CSEMANA=S.CSEMANA AND N.CCVE_EMPL=S.CCVE_EMPL
WHERE N.CCVE_TEMPORADA = '@TEMPORADA' AND N.CCVE_NOMINA='01' AND N.CSEMANA='@SEMANA' --and substring(CCVE_COS,9,4) not in ('4501') --and n.CCVE_EMPL in (60127,60674,60712,60763,60781,61549,71048,71188,71714,71803,71900,71994,72052,72087,72095,72133,72168)
GROUP BY N.CCVE_EMPL,N.CCVE_NOMINA,N.CCVE_TEMPORADA 
HAVING (
  (MAX(N.NIMP_DIA1+N.NANT_DIA1+NSEP_DIA1+NPROD_DIA1)<>SUM(CASE WHEN CDIA=1 THEN S.NIMPORTE ELSE 0 END))
  OR
  (MAX(N.NIMP_DIA2+N.NANT_DIA2+NSEP_DIA2+NPROD_DIA2)<>SUM(CASE WHEN CDIA=2 THEN S.NIMPORTE ELSE 0 END))
  OR
  (MAX(N.NIMP_DIA3+N.NANT_DIA3+NSEP_DIA3+NPROD_DIA3)<>SUM(CASE WHEN CDIA=3 THEN S.NIMPORTE ELSE 0 END))
  OR
  (MAX(N.NIMP_DIA4+N.NANT_DIA4+NSEP_DIA4+NPROD_DIA4)<>SUM(CASE WHEN CDIA=4 THEN S.NIMPORTE ELSE 0 END))  
  OR
  (MAX(N.NIMP_DIA5+N.NANT_DIA5+NSEP_DIA5+NPROD_DIA5)<>SUM(CASE WHEN CDIA=5 THEN S.NIMPORTE ELSE 0 END))
  OR
  (MAX(N.NIMP_DIA6+N.NANT_DIA6+NSEP_DIA6+NPROD_DIA6)<>SUM(CASE WHEN CDIA=6 THEN S.NIMPORTE ELSE 0 END))
  OR
  (MAX(N.NIMP_DIA7+N.NANT_DIA7+NSEP_DIA7+NPROD_DIA7)<>SUM(CASE WHEN CDIA=7 THEN S.NIMPORTE ELSE 0 END))
  )
  OR
  (MAX(N.NIMP_DIA7+N.NANT_DIA7+NSEP_DIA7+NPROD_DIA7)<(SELECT TOP 1 T.NSUELDODIARIO+T.NSEPTIMO FROM nom_tabla_sueldos T WHERE T.ccve_nomina =N.CCVE_NOMINA AND T.ccve_temporada <= N.CCVE_TEMPORADA ORDER BY T.ccve_temporada DESC))

--ORDER BY N.CCVE_EMPL


SELECT * 
FROM #RESULTADO
WHERE DIA1<>0 OR DIA2<>0 OR DIA3<>0 OR DIA4<>0 OR DIA5<>0 OR DIA6<>0 OR DIA7<>0

DROP TABLE #RESULTADO